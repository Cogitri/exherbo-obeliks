# Copyright 2010 Bernhard Frauendienst
# Distributed under the terms of the GNU General Public License v2

require aqbanking [ release=74 ]

PLATFORMS="~amd64 ~x86"

DEPENDENCIES="
    build+run:
        dev-libs/gmp
        dev-libs/gnutls
        dev-libs/libtasn1
        finance/ktoblzcheck[>=1.10]
        sys-libs/gwenhywfar[>=4.0.0.0]
        chipcard? ( sys-libs/libchipcard[>=4.2.9] )
        ofx? ( finance/libofx[>=0.9.1] )
"

MYOPTIONS="
    chipcard [[ description = [ support for chipcard readers ] ]]
    debug
    ofx [[ description = [ backend for OFX (Open Financial eXchange) Direct Connect ] ]]
    paypal [[ description = [ backend for PayPal (has different licencing) ] ]]
"

LICENCES+=" paypal? ( AqPaypal )"

# parallel make fails
DEFAULT_SRC_COMPILE_PARAMS=( -j1 )

src_configure() {
    local backends="aqhbci aqnone"
    option ofx && backends+=" aqofxconnect" || ewarn "The build system fails if the aqofxconnect backend is deselected"
    option paypal && backends+=" aqpaypal"

    econf \
        --with-docpath=/usr/share/doc/${PNVR}/apidoc \
        --with-backends="${backends}" \
        $(option_enable debug)
}


